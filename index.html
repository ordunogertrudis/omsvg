-- main - Database Schema for omsvg
-- Created: $(date)

-- Users table
CREATE TABLE IF NOT EXISTS users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Posts table
CREATE TABLE IF NOT EXISTS posts (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    title VARCHAR(200) NOT NULL,
    content TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Indexes for better performance
CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
CREATE INDEX IF NOT EXISTS idx_posts_user_id ON posts(user_id);
CREATE INDEX IF NOT EXISTS idx_posts_created_at ON posts(created_at);

-- Sample data insertion
INSERT INTO users (username, email, password_hash) VALUES
('john_doe', 'john@example.com', 'hashed_password_123'),
('jane_smith', 'jane@example.com', 'hashed_password_456');

INSERT INTO posts (user_id, title, content) VALUES
(1, 'First Post', 'This is the content of the first post.'),
(2, 'Welcome Post', 'Welcome to our application!');

-- Useful queries
-- Get all posts with user information
SELECT
    p.title,
    p.content,
    p.created_at,
    u.username
FROM posts p
JOIN users u ON p.user_id = u.id
ORDER BY p.created_at DESC;

-- Get user post count
SELECT
    u.username,
    COUNT(p.id) as post_count
FROM users u
LEFT JOIN posts p ON u.id = p.user_id
GROUP BY u.id, u.username;

# Additional Implementation 1760498325

# Additional Implementation 1760498325

# Code Update 1760498326-26883

# Code Update 1760498326-2251

# Code Update 1760498326-14990

# Code Update 1760498326-26472

# Code Update 1760498326-22054

# Code Update 1760498326-4647

# Additional Implementation 1760498326

# Code Update 1760498326-3796

# Additional Implementation 1760498326

# Code Update 1760498326-22194

# Additional Implementation 1760498326

# Additional Implementation 1760498326

# Additional Implementation 1760498327

# Code Update 1760498327-20409

# Code Update 1760498327-13296

# Additional Implementation 1760498327

# Code Update 1760498327-14733

# Additional Implementation 1760498327

# Code Update 1760498327-21998

# Additional Implementation 1760498327

# Code Update 1760498327-21566

# Code Update 1760498327-24682

# Additional Implementation 1760498327

# Additional Implementation 1760498327

# Additional Implementation 1760498327

# Code Update 1760498327-29638

# Additional Implementation 1760498327

# Additional Implementation 1760498327

# Code Update 1760498327-15879

# Code Update 1760498327-2453

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Additional Implementation 1760498328

# Code Update 1760498329-901

# Code Update 1760498329-27522

# Code Update 1760498329-8682

# Additional Implementation 1760498329

# Additional Implementation 1760498329

# Code Update 1760498329-22365

# Additional Implementation 1760498329

# Additional Implementation 1760498329

# Code Update 1760498329-23618

# Additional Implementation 1760498329

# Code Update 1760498329-25649

# Code Update 1760498330-5642

# Additional Implementation 1760498330

# Code Update 1760498330-27245

# Additional Implementation 1760498330

# Code Update 1760498330-16606

# Code Update 1760498330-23426

# Code Update 1760498330-1631

# Additional Implementation 1760498330

# Code Update 1760498330-9121

# Additional Implementation 1760498331

# Additional Implementation 1760498331

# Additional Implementation 1760498331

# Additional Implementation 1760498331

# Code Update 1760498331-31382

# Additional Implementation 1760498331

# Additional Implementation 1760498331

# Additional Implementation 1760498331

# Code Update 1760498331-13785

# Code Update 1760498331-10168

# Code Update 1760498331-22699

# Code Update 1760498331-17921

# Code Update 1760498332-16309

# Additional Implementation 1760498332

# Code Update 1760498332-28603

# Additional Implementation 1760498332

# Code Update 1760498332-26255

# Additional Implementation 1760498332

# Additional Implementation 1760498332
